<?php ?>
<table id="raw_cert_data_dt_table" class="table table-sm table-striped table-bordered dataTable no-footer" cellpadding="0" role="grid">
    <thead><tr role="row">
            <th class="dt_name sorting_asc" tabindex="0" aria-controls="raw_cert_data_dt_table" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Name: activate to sort column descending">Name</th>
            <th class="dt_name sorting" tabindex="0" aria-controls="raw_cert_data_dt_table" rowspan="1" colspan="1" aria-label="Code: activate to sort column ascending">Code</th>
            <th class="dt_name sorting" tabindex="0" aria-controls="raw_cert_data_dt_table" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending">Status</th>
            <th class="dt_name sorting" tabindex="0" aria-controls="raw_cert_data_dt_table" rowspan="1" colspan="1" aria-label="Action: activate to sort column ascending">Action</th>
        </tr>
    </thead>
    <tbody>
        <tr role="row" class="odd">
            <td class=" dt_name">Manage Actions</td>
            <td class=" dt_name">MANAGE_ACTIONS</td>
            <td class=" dt_name">active</td>
            <td class=" dt_name">
                <a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzFkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-eye"></i>
                </a> 
                <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzFkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzFkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
        <tr role="row" class="even">
            <td class=" dt_name">Manage Modules</td>
            <td class=" dt_name">MANAGE_MODULES</td>
            <td class=" dt_name">active</td>
            <td class=" dt_name">
                <a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzJkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-eye"></i>
                </a> 
                <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzJkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-edit"></i>
                </a> 
                <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzJkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
        <tr role="row" class="odd">
            <td class=" dt_name">Manage Permissions</td>
            <td class=" dt_name">MANAGE_PERMISSIONS</td>
            <td class=" dt_name">active</td>
            <td class=" dt_name">
                <a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzNkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-eye"></i>
                </a> 
                <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzNkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzNkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
        <tr role="row" class="even">
            <td class=" dt_name">Manage Menu</td>
            <td class=" dt_name">MANAGE_MENU</td>
            <td class=" dt_name">active</td>
            <td class=" dt_name">
                <a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzRkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-eye"></i>
                </a> 
                <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzRkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-edit"></i>
                </a> 
                <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzRkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style="">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
        <tr role="row" class="odd"><td class=" dt_name">Upload Utilities</td><td class=" dt_name">UPLOAD_UTILITIES</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzVkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzVkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzVkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="even"><td class=" dt_name">Users</td><td class=" dt_name">USERS</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzZkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzZkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzZkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="odd"><td class=" dt_name">Manage Roles</td><td class=" dt_name">USER_ROLES</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzdkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzdkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzdkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="even"><td class=" dt_name">Manage Book Ledger</td><td class=" dt_name">MANAGE_BOOK_LEDGER</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzhkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzhkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzhkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="odd"><td class=" dt_name">Manage Book Category</td><td class=" dt_name">MANAGE_BOOK_CATEGORY</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzlkZjJm" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzlkZjJm" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzlkZjJm" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="even"><td class=" dt_name">Manage Book Publication</td><td class=" dt_name">MANAGE_BOOK_PUBLICATION</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzEwZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzEwZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzEwZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="odd"><td class=" dt_name">Manage Book Author</td><td class=" dt_name">MANAGE_BOOK_AUTHOR</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzExZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzExZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzExZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="even"><td class=" dt_name">Manage Book Location</td><td class=" dt_name">MANAGE_BOOK_LOCATION</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzEyZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzEyZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzEyZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="odd"><td class=" dt_name">Assign Books</td><td class=" dt_name">ASSIGN_BOOKS</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzEzZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzEzZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzEzZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="even"><td class=" dt_name">Manage App Configs</td><td class=" dt_name">MANAGE_APP_CONFIGS</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzE0ZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzE0ZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzE0ZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr><tr role="row" class="odd"><td class=" dt_name">Staff Users</td><td class=" dt_name">STAFF_USERS</td><td class=" dt_name">active</td><td class=" dt_name"><a class="btn btn-info btn-xs" href="http://localhost:81/ion_school/view-rbac-module/NzY2MzE1ZGYyZg##" title="view record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-eye"></i></a> <a class="btn btn-primary btn-xs" href="http://localhost:81/ion_school/edit-rbac-module/NzY2MzE1ZGYyZg##" title="edit record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-edit"></i></a> <a class="btn btn-danger delete-record btn-xs" data-module_id="NzY2MzE1ZGYyZg##" href="#" title="delete record" data-toggle="tooltip" data-placement="top" style=""><i class="fas fa-trash-alt"></i></a></td></tr></tbody></table>

<script type="text/javascript">
    $(document).ready(function () {

        var raw_cert_data_dt_table_obj = $('#raw_cert_data_dt_table').DataTable({
            'columns': [
                {title: "Name", name: "Name", className: "dt_name", orderable: true, targets: "0", searchable: true, },
                {title: "Code", name: "Code", className: "dt_name", orderable: true, targets: "1", searchable: true, },
                {title: "Status", name: "Status", className: "dt_name", orderable: true, targets: "2", searchable: true, },
                {title: "Action", name: "Action", className: "dt_name", orderable: true, targets: "3", searchable: false, }
            ],
            'bPaginate': true,
            'bAutoWidth': false,
            'bDeferRender': true,
            'bFilter': false,
            'bLengthChange': true,
            'bInfo': true,
            'bSort': true,
            'bSortClasses': false,
            'bProcessing': true,
            'bServerSide': true,
            'scrollY': '',
            'sScrollX': '',
            'bScrollCollapse': '',
            'bSortCellsTop': true,
            'iDisplayLength': 15,
            'iDisplayStart': 0,
            'sScrollXInner': '',
            'searching': true,
            'lengthMenu': [15, 30, 60, 100],
            "order": [[0, "asc"]],
            'dom':"<'row'<'col-sm-12 col-md-1'l> <'col-sm-12 col-md-9' <'raw_cert_data_dt_table_dt_button float-right'>><'col-sm-12 col-md-2'f>> <'row' <'col-sm-12'tr>> <'row' <'col-sm-12 col-md-5'i> <'col-sm-12 col-md-7'p>>",
            'language': {
                "sZeroRecords": "<div class='text-center'><\/div>",
                "sEmptyTable": "<div class='text-center'><\/div>",
                "sProcessing": "<div class='text-center'><\/div>",
                "sLengthMenu": " _MENU_ ",
                "search": "_INPUT_",
                "searchPlaceholder": "Search",
                "oPaginate": {
                    "sFirst": false,
                    "sPrevious": false,
                    "sNext": false,
                    "sLast": false}},
            'ajax': {
                "beforeSend": function () {
                    jQuery("#raw_cert_data_dt_table_loading").css("display", "block");
                },
                "complete": function () {
                    jQuery("#raw_cert_data_dt_table_loading").css("display", "none");
                },
                "async": "true",
                "url": "http://localhost:81/ion_school/rbac-modules-list",
                "type": "POST",
                "dataType": "JSON",
                "data": function (d) {
                    return $.extend({}, d, {
                    });
                }},
        });
        var raw_cert_data_dt_table_extra_head = "";
        $('.raw_cert_data_dt_table_table_cont').find('div.dataTables_scrollHeadInner').find('table').find('thead').prepend(raw_cert_data_dt_table_extra_head);
        if ($.fn.DataTable.isDataTable($('#raw_cert_data_dt_table'))) {
            if (typeof raw_cert_data_dt_table_obj != 'undefined') {
                $(".raw_cert_data_dt_table_dt_button").append('<a class="btn btn-primary btn-xs"  href="http://localhost:81/ion_school/create-rbac-module" title="Create" data-toggle="tooltip" data-placement="top"><i class="fas "></i>Create</a> <a class="btn btn-warning btn-xs" id="export_table_xls" href="#" title="XLS" data-toggle="tooltip" data-placement="top"><i class="fas "></i><span class="fa fa-file-excel-o"></span> Excel</a> <a class="btn btn-info btn-xs" id="export_table_csv" href="#" title="CSV" data-toggle="tooltip" data-placement="top"><i class="fas "></i><span class="fa fa-file-text-o"></span> CSV</a> ');
            }
        }
        window.win_raw_cert_data_dt_table_obj = raw_cert_data_dt_table_obj;
        $('.dataTables_filter input').addClass('search_box_dt_cls');
        $('.dataTables_length select').addClass('chosen-dt-length-select');
        $('.chosen-dt-length-select').chosen({allow_single_deselect: true, disable_search: true, width: 50});
        $(".chosen-dt-length-select").chosen({disable_search_threshold: 10});
    });
</script>

<script type="text/javascript">
    $(function ($) {
//delete record

        $(document).on('click', '.delete-record', function (e) {
            e.preventDefault();
            var data = {'module_id': $(this).data('module_id')}
            var row = $(this).closest('tr');
            BootstrapDialog.show({
                title: 'Alert',
                message: 'Do you want to delete the record?',
                buttons: [{
                        label: 'Cancel',
                        action: function (dialog) {
                            dialog.close();
                        }
                    }, {
                        label: 'Delete',
                        action: function (dialog) {
                            $.ajax({
                                url: 'http://localhost:81/ion_school/rbac/rbac_modules/delete',
                                method: 'POST',
                                data: data,
                                success: function (result) {
                                    if (result == 1) {
                                        dialog.close();
                                        row.hide();
                                        BootstrapDialog.alert('Record successfully deleted!');
                                    } else {
                                        dialog.close();
                                        BootstrapDialog.alert('Data deletion error,please contact site admin!');
                                    }
                                },
                                error: function (error) {
                                    dialog.close();
                                    BootstrapDialog.alert('Error:' + error);
                                }
                            });
                        }
                    }]
            });

        });
//export raw data as excel 

        $(document).on('click', '#export_table_xls', function (e) {
            e.preventDefault();
            $('#loading').css('display', 'block');
            var param = {
                "export_type": 'xlsx'
            };
            $.ajax({
                type: 'POST',
                url: "http://localhost:81/ion_school/rbac/rbac_modules/export_grid_data",
                data: param,
                dataType: 'json'
            }).done(function (data) {
                download(data.file, data.file_name, 'application/octet-stream');
                $('#loading').css('display', 'none');
            });
        });
        //export raw data as csv 

        $(document).on('click', '#export_table_csv', function (e) {
            e.preventDefault();
            $('#loading').css('display', 'block');
            var param = {
                "export_type": 'csv'
            };
            $.ajax({
                type: 'POST',
                url: "http://localhost:81/ion_school/rbac/rbac_modules/export_grid_data",
                data: param,
                dataType: 'json'
            }).done(function (data) {
                download(data.file, data.file_name, 'application/octet-stream');
                $('#loading').css('display', 'none');
            });
        });

    });
</script>